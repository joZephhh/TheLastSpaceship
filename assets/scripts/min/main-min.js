function randomColor(){var t=Math.round(360*Math.random());return"hsl("+t+",100%,30%)"}function resize(){canvas.width=window.innerWidth,canvas.height=window.innerHeight}function init(){tls.el.body.style="background: red",tls.el.nameGalaxy.innerText=tls_dtb.galaxy.name;for(var t=0;400>t;t++){var a={};a.x=Math.floor(Math.random()*canvas.width),a.y=Math.floor(Math.random()*canvas.width),a.velocity={},a.velocity.x=(4*Math.random()-2)/10,a.velocity.y=(4*Math.random()-2)/10,a.style="white",a.radius=2*Math.random(),particles.push(a)}loop()}function update_particles(){for(var t=0;t<particles.length;t++){var a=particles[t];a.x+=a.velocity.x,a.y+=tls.data.speed,(a.x>canvas.width||a.x<0||a.y>canvas.height||a.y<0)&&(particles.splice(t,1),t--)}}function add_particle(){var t={};t.x=Math.floor(Math.random()*canvas.width),t.y=0,t.velocity={},t.velocity.x=(4*Math.random()-2)/10,t.velocity.y=(4*Math.random()-2)/10,t.style="white",t.radius=2*Math.random(),particles.push(t)}function draw(){context.clearRect(0,0,canvas.width,canvas.height);for(var t=0;t<particles.length;t++){var a=particles[t];context.beginPath(),context.arc(a.x,a.y,a.radius,0,2*Math.PI),context.fillStyle=a.style,context.fill()}}function loop(){window.requestAnimationFrame(loop),add_particle(),update_particles(),draw()}function restore(){var t=new Date,a=parseFloat(localStorage.getItem("tls_date")),e=Math.round((t.getTime()-a)/1e3);tls.data.distance-100*e>0?tls.data.distance-=100*e:tls.data.distance=0}function add_distance(){var t=tls_dtb.objects.reactors.maxSpeed;tls.data.distance+1*tls.data.multi_distance<t?(tls.data.distance+=1*tls.data.multi_distance,tls.el.dataSpeed.style="color:#2ecc71",tls.el.unitSecNb.classList.remove("unit-max")):(tls.data.distance=t,tls.el.dataSpeed.style="color:orange",tls.el.unitSecNb.classList.add("unit-max"))}function remove_distance(){tls.data.distance>0&&(tls.data.distance-=1,tls.el.dataSpeed.innerText=tls.data.distance,tls.el.dataSpeed.style="color:#e74c3c",tls.el.unitSecNb.classList.remove("unit-max"))}function rebootStationary(){clearInterval(stationary),clearTimeout(timeoutStandby),timeoutStandby=setTimeout(function(){stationary=setInterval(function(){remove_distance()},10)},3e3)}function money(){tls.data.money<tls_dtb.objects.starsContainer.canContain?tls.data.money=Math.floor(tls.data.distanceStars/1e3):tls.data.money=tls_dtb.objects.starsContainer.canContain,tls.el.dataMoney.innerText=tls.data.money}function buy(t){tls.data.distanceStars-t>=0&&(tls.data.distanceStars-=t)}function unitsTotal(){tls.data.distanceTotal>0&&tls.data.distanceTotal<1e3?(tls.el.dataTotal.innerText=tls.data.distanceTotal,tls.el.unitTotal.innerText="mètres parcourus au total"):tls.data.distanceTotal>1e3&&(tls.el.dataTotal.innerText=Math.round(tls.data.distanceTotal/1e3),tls.el.unitTotal.innerText="kilomètres parcourus au total")}function unitsSec(){tls.data.distance>=0&&tls.data.distance<1e3?(tls.el.dataSpeed.innerText=tls.data.distance,tls.el.unitSec.innerText="mètres /s"):tls.data.distanceTotal>1e3&&(tls.el.dataSpeed.innerText=Math.round(tls.data.distance/1e3*10)/10,tls.el.unitSec.innerText="kilomètres /s")}function stillInGalaxy(){tls_dtb.galaxy.size-tls.data.currentPosition>0?tls_dtb.galaxy.size-tls.data.currentPosition>1e3?(tls.el.numberStill.innerText=Math.round((tls_dtb.galaxy.size-tls.data.currentPosition)/1e3*100)/100,tls.el.unitStill.innerText=" kilomètres"):(tls.el.numberStill.innerText=tls_dtb.galaxy.size-tls.data.currentPosition,tls.el.unitStill.innerText=" mètres"):changeGalaxy()}function changeGalaxy(){animationNewGalaxy()&&(tls_dtb.galaxy.name="Demedoran",tls_dtb.galaxy.range+=1,tls_dtb.galaxy.size=tls_dtb.galaxy.size*tls_dtb.galaxy.ratio,tls_dtb.galaxy.color=randomColor(),tls.data.currentPosition=0,tls.el.body.style="background: linear-gradient( to top,"+tls_dtb.galaxy.color+" ,#000000);",localStorage.setItem("tls_database",JSON.stringify(tls_dtb)))}function animationNewGalaxy(){return tls.el.game.classList.add("changingGalaxy"),setTimeout(function(){tls.el.game.classList.remove("changingGalaxy"),tls.el.game.classList.add("changingGalaxy-2"),setTimeout(function(){tls.el.game.classList.remove("changingGalaxy-2")},500)},1700),!0}function checkData(){console.log(tls.data.distanceTotal),tls.data.multi_distance=1+Math.floor(tls.data.distance/150),tls.data.speed<=25?tls.data.speed=1+Math.floor(tls.data.distance/5/50):tls.data.speed=25,unitsSec(),unitsTotal(),stillInGalaxy(),document.title="TLS : "+tls.data.distance+" an. lu. /sec."}function loop_data(){window.requestAnimationFrame(loop_data),checkData()}function tls_reset(){localStorage.setItem("tls_distance_total",0),localStorage.setItem("tls_distance_stars",0),localStorage.setItem("tls_distance",0),console.log("done")}function upgradeSpeed(){tls_dtb.objects.reactors.maxSpeed=tls_dtb.objects.reactors.maxSpeed*tls_dtb.objects.reactors.ratio,tls_dtb.objects.reactors.level+=1,localStorage.setItem("tls_database",JSON.stringify(tls_dtb))}console.log("script linked");var tls_dtb;tls_dtb=localStorage.getItem("tls_database")?JSON.parse(localStorage.getItem("tls_database")):{objects:{tank:{lvl:1,dimSpeed:2,ratio:1.2},reactors:{lvl:1,maxSpeed:1e3,ratio:1.2},starsContainer:{lvl:1,canContain:75,ratio:2}},galaxy:{name:"d'Andromède",range:1,size:1e3,ratio:5,color:"#4b6cb7"}},console.log(tls_dtb.galaxy.color);var tls={};tls.el={},tls.el.body=document.querySelector("body"),tls.el.container=document.querySelector(".container-game"),tls.el.launch_page=tls.el.container.querySelector(".landing-page"),tls.el.game=tls.el.container.querySelector(".game"),tls.el.colorInput=tls.el.container.querySelector(".colorSpaceship"),tls.el.spaceship=tls.el.game.querySelector(".game-spaceship svg"),tls.el.svgPersoParts=tls.el.spaceship.querySelectorAll(".spaceship-personalisation"),tls.el.unitTotal=tls.el.game.querySelector(".units-total"),tls.el.unitSecNb=tls.el.game.querySelector(".unit-sec-nb"),tls.el.unitSec=tls.el.game.querySelector(".units-sec"),tls.el.unitStill=tls.el.game.querySelector(".units-still"),tls.el.numberStill=tls.el.game.querySelector(".galaxy-still-dist"),tls.el.nameGalaxy=tls.el.game.querySelector(".galaxy-name"),tls.el.dataTotal=tls.el.game.querySelector(".game-total-data span"),tls.el.dataSpeed=tls.el.game.querySelector(".game-data-speed .game-data-info span"),tls.el.dataMoney=tls.el.game.querySelector(".game-data-money .game-data-info span"),tls.data={},localStorage.getItem("tls_distance")?tls.data.distance=parseFloat(localStorage.getItem("tls_distance")):tls.data.distance=0,localStorage.getItem("tls_distance_total")?tls.data.distanceTotal=parseFloat(localStorage.getItem("tls_distance_total")):tls.data.distanceTotal=0,localStorage.getItem("tls_distance_stars")?tls.data.distanceStars=parseFloat(localStorage.getItem("tls_distance_stars")):tls.data.distanceStars=0,localStorage.getItem("tls_current_position")?tls.data.currentPosition=parseFloat(localStorage.getItem("tls_current_position")):tls.data.currentPosition=0,tls.data.multi_distance=.5,tls.data.speed=.5,tls.data.money=0,tls.el.start_btn=tls.el.launch_page.querySelector(".ld-start");var canvas=document.querySelector("canvas"),context=canvas.getContext("2d");window.addEventListener("resize",resize),resize();var particles=[];init(),tls.el.start_btn.addEventListener("click",function(t){restore(),loop_data(),t.preventDefault(),tls.el.launch_page.classList.add("launch"),tls.el.dataSpeed.innerText=tls.data.distance,setTimeout(function(){tls.el.launch_page.remove(),tls.el.game.classList.add("launched")},800),setTimeout(function(){rebootStationary()},5e3)}),tls.el.spaceship.addEventListener("click",function(){rebootStationary(),add_distance(),console.log("spaceship clicked")}),setInterval(function(){tls.data.distanceTotal+=1*tls.data.distance,tls.data.distanceStars+=1*tls.data.distance,tls.data.currentPosition+=1*tls.data.distance,money()},1e3);var stationary,timeoutStandby;tls.el.colorInput.addEventListener("blur",function(){for(var t=0;t<tls.el.svgPersoParts.length;t++)tls.el.svgPersoParts[t].style="fill:"+tls.el.colorInput.value}),document.querySelector(".testShop").addEventListener("click",function(){upgradeSpeed()});